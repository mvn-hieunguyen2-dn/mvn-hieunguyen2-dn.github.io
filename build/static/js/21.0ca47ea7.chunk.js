(this.webpackJsonpfruit_managenment_fe=this.webpackJsonpfruit_managenment_fe||[]).push([[21],{168:function(t,e,n){"use strict";n.d(e,"e",(function(){return r})),n.d(e,"a",(function(){return c})),n.d(e,"b",(function(){return a})),n.d(e,"d",(function(){return u})),n.d(e,"c",(function(){return o}));var r=function(t){return t.user},c=function(t){return t.app},a=function(t){return t.exam},u=function(t){return t.notification},o=function(t){return t.messenger}},195:function(t,e,n){"use strict";n.d(e,"f",(function(){return f})),n.d(e,"d",(function(){return d})),n.d(e,"a",(function(){return b})),n.d(e,"b",(function(){return h})),n.d(e,"g",(function(){return l})),n.d(e,"e",(function(){return j})),n.d(e,"c",(function(){return p}));var r=n(0),c=n.n(r),a=n(4),u=n(16),o=n(15),s=n(25);function i(t){for(var e="",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=n.length,c=0;c<t;c++)e+=n.charAt(Math.floor(Math.random()*r));return e}var f=function(t){return function(){var e=Object(a.a)(c.a.mark((function e(n){var r,a,i,f,d;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(u.e)(Object(u.d)(s.g,"chats/".concat(t)));case 2:if(r=e.sent,n({type:o.u,payload:{currentRoom:r.data()}}),n({type:o.c}),t){e.next=7;break}return e.abrupt("return");case 7:return a=[],i=Object(u.k)(Object(u.b)(s.g,"chats/".concat(t,"/messages")),Object(u.j)("createdAt","desc"),Object(u.h)(15)),e.next=11,Object(u.f)(i);case 11:if(f=e.sent,d=f.docs[f.docs.length-1]){e.next=15;break}return e.abrupt("return");case 15:f.forEach((function(t){return a.push(t.data())})),n({type:o.w,payload:{messages:a,lastVisible:d}});case 17:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},d=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return function(){var r=Object(a.a)(c.a.mark((function r(a){var i,f,d,b;return c.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(i=[],t&&e&&0!==n.length){r.next=3;break}return r.abrupt("return",!0);case 3:return f=Object(u.k)(Object(u.b)(s.g,"chats/".concat(t,"/messages")),Object(u.j)("createdAt","desc"),Object(u.m)(e),Object(u.h)(10)),r.next=6,Object(u.f)(f);case 6:if(d=r.sent,b=d.docs[d.docs.length-1]){r.next=10;break}return r.abrupt("return",!0);case 10:return d.forEach((function(t){return i.push(t.data())})),a({type:o.i,payload:{messages:n.concat(i),lastVisible:b}}),r.abrupt("return",!0);case 13:case"end":return r.stop()}}),r)})));return function(t){return r.apply(this,arguments)}}()},b=function(t,e,n){return function(r){if(t&&n&&0!==e.trim().length){var c=i(10),a={message:e,author:n,checked:!1,createdAt:Date.now()},o="chats/".concat(t,"/messages"),f=Object(u.d)(s.g,"chats",t);Object(u.e)(f).then((function(t){t.exists()&&Object(u.l)(Object(u.d)(s.g,o,c),a).then((function(){})).catch((function(t){return console.log(t.message)}))})).catch((function(t){return alert(t.message)}))}}},h=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];return function(c){if(t&&e&&0!==(null===n||void 0===n?void 0:n.length)&&0!==(null===r||void 0===r?void 0:r.length)){var a,f=Object(u.k)(Object(u.b)(s.g,"chats"),Object(u.n)("members","array-contains","".concat(e)));Object(u.f)(f).then((function(t){var e=[];t.forEach((function(t){e.push(t.data())})),a=e.find((function(t){return JSON.stringify(null===t||void 0===t?void 0:t.members.sort())===JSON.stringify(r.sort())}))})).then((function(){if(a){var e;null===t||void 0===t||t.push("/messages/".concat(null===(e=a)||void 0===e?void 0:e.roomId))}else{var f=i(10),d={createdAt:Date.now(),members:r,roomId:f,membersDetails:n};Object(u.l)(Object(u.d)(s.g,"chats",f),d).then((function(){c({type:o.u,payload:{currentRoom:d}}),null===t||void 0===t||t.push("/messages/".concat(f))}))}}))}}},l=function(t){return function(e){var n=Object(u.k)(Object(u.b)(s.g,"chats"),Object(u.n)("members","array-contains","".concat(null===t||void 0===t?void 0:t.uid)),Object(u.j)("createdAt","desc"),Object(u.h)(10));Object(u.f)(n).then((function(t){var n=[];t.forEach((function(t){n.push(t.data())})),e({type:o.x,payload:{rooms:n,lastVisible:t.docs[t.docs.length-1]}})})).catch((function(t){console.log(t.message)}))}},j=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return function(){var r=Object(a.a)(c.a.mark((function r(a){var i,f,d,b;return c.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(i=Object(u.k)(Object(u.b)(s.g,"chats"),Object(u.n)("members","array-contains","".concat(null===t||void 0===t?void 0:t.uid),Object(u.j)("createdAt","desc"),Object(u.m)(e),Object(u.h)(5))),f=[],t&&e&&0!==n.length){r.next=4;break}return r.abrupt("return",!0);case 4:return r.next=6,Object(u.f)(i);case 6:if(d=r.sent,b=d.docs[d.docs.length-1]){r.next=10;break}return r.abrupt("return",!0);case 10:return d.forEach((function(t){return f.push(t.data())})),a({type:o.k,payload:{rooms:f,lastVisibleRoom:b}}),r.abrupt("return",!0);case 13:case"end":return r.stop()}}),r)})));return function(t){return r.apply(this,arguments)}}()},p=function(t){return function(e){Object(u.c)(Object(u.d)(s.g,"chats/".concat(t))).then((function(){e({type:o.f,payload:{roomId:t}})}))}}},325:function(t,e,n){"use strict";n.r(e);var r=n(11),c=n(55),a=(n(5),n(13)),u=function(t){t.currentUser,t.currentMessages,t.fetchMoreMessages,t.lastVisible,t.initMessages;return Object(a.jsx)("div",{className:"test"})},o=n(168),s=n(195);e.default=Object(c.b)((function(t){return Object(r.a)(Object(r.a)({},Object(o.e)(t)),Object(o.c)(t))}),{fetchMoreMessages:s.d,initMessages:s.f})(u)}}]);
//# sourceMappingURL=21.0ca47ea7.chunk.js.map